<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>Conditional "import" in Python</title>
    <meta name="author" content="Vasudev Kamath" />

    <!-- Normalize CSS -->
    <link rel="stylesheet" href="/css/normalize.css" type="text/css"/>

    <!-- 1140 Grid CSS -->
    <link media="screen" rel="stylesheet" href="/css/1140.css" type="text/css"/>

    <!-- styles.css -->
    <link media="screen" rel="stylesheet" href="/css/styles.css" type="text/css"/>

    <!-- 1140 Grid CSS related javascript -->
    <script src="/js/css3-mediaqueries.js" type="text/javascript"></script>

    
    <!-- syntax highlighting CSS -->
    <link rel="stylesheet" href="/css/emacs.css" type="text/css" />

    <!-- Webfont url -->
    <link rel="stylesheet" href="/fonts/stylesheet-bitstream.css" type="text/css"/>
    <link rel="stylesheet" href="/fonts/stylesheet-angelina.css" type="text/css"/>
    <link rel="stylesheet" href="/fonts/stylesheet-aargh.css" type="text/css"/>
    <link rel="stylesheet" href="/fonts/stylesheet-lato.css" type="text/css"/>    

    <!-- Homepage CSS -->
    <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />
  </head>
  <body>

    <div class="container header">
      <div class="row">
        <div class="site">
          <div class="title">
            <a href="/">Random Ramblings</a>
          </div>
          <div class="subheading">
            Random thoughts shooting out of volatile mind
          </div>
        </div>
      </div>
    </div>
    <div class="container details">
      <div class="row">
        <div class="eightcol">
          <div class="postheading">
  Conditional "import" in Python
</div>
<div class="postbody">
  <div style="text-align: justify;">Normally in Python when we try to import a module and module doesn't exist the interpreter will throw&nbsp; <i>ImportError</i>, this is a normal behavior . But in some cases like when Python version changes some functions are moved from one module to other and sometime the module names itself are changed. For eg. in Python 2.6 we have <i>urllib</i> <i>urllib2</i> modules but in Py3k these modules are combined and all request response related functions are present in <i>urllib.request</i> and all errors are unders <i>urrlib.error</i> module. Functions like <i>urlencode</i> <i>quote</i> <i>unquote</i> which were in <i>urllib</i> module in Python2.6 are under <i>urllib.request </i>Py3k. This case of moving from Python 2.x to Py3k can be easily done by tool called <i>2to3.</i>But lets say moving from Python2.5 to Python2.6 how do we handle this situation?. Well below is the solution <i>(applicable when modules are renamed or moved during version change)</i></div><br /><div style="text-align: justify;"><i><b>Problem:</b></i> When I started working on <a href="http://smc.org.in/silpa">SILPA</a> I was running Debian Squeeze which had Python 2.5 as system default Python, but recently Debian Squeeze transitioned to Python 2.6 as default Python. We had some issue in the URL routing logic of the SILPA which I fixed 2 days back for which I used a function called <i>parse_qs </i>from <i>urlparse</i> module and everything worked fine on my system. I pushed the changes to the main git repository. Now the problem begins 2 mirrors of SILPA have Cron job setup to periodically pull the changes from git, and next day it was reported that 2 of the mirrors where throwing 500 internal server error. And its time for me to find what was causing the issue :).</div><br /><div style="text-align: justify;"><i><b>Reason:</b></i> Mirror instance of the SILPA were running older version of Python.(2.5) and the function <i>parse_qs</i> was not defined in the module <i>urlparse</i> which was causing the <i>ImportError</i>.</div><br /><div style="text-align: justify;"><i><b>Solution:</b></i> I figured out that in Python 2.5 version <i>parse_qs</i> is present but in <i>cgi</i> module instead of <i>urlparse</i>. So to make the code work in both Python versions (i.e. 2.5 and 2.6) I need to do a conditional import as shown below</div><br /><blockquote><i>try:</i><br /><i>&nbsp; &nbsp; from urlparse import parse_qs</i><br /><i>except ImportError:</i><br /><i>&nbsp; &nbsp; # Fall back for Python 2.5 </i><br /><i>&nbsp; &nbsp; from cgi import parse_qs </i></blockquote><br /><div style="text-align: justify;"> So I want to import <i>parse_qs</i> from <i>urlparse</i> module and if interpreter throws <i>ImportError</i> it means the Python version is &lt;2.6 so import the function from <i>cgi</i> module instead. So code is now backward compatible with Python2.5. Well that's it I call this as conditional importing I don't know what is the exact name for this method :). If you have any suggestions please do comment.</div><br />-- Vasudev

  <br/>
  <div class="meta_wrapper">
<ul class="tag_list_in_post">
    
    <li class="inline tag_list_item"><a class="tag_list_link" href="/tag/Programming">Programming</a></li>
    
    <li class="inline tag_list_item"><a class="tag_list_link" href="/tag/python">python</a></li>
    
</ul>
</div>
  
</div>
<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
    <li><span>11 Mar 2012</span> &raquo; <a href="/2012/03/hello_planet%21.html">Hello Planet! (Debian)</a></li>
    
    <li><span>10 Mar 2012</span> &raquo; <a href="/2012/03/ttf-indic-fonts_to_fonts-indic_transition_complete%21.html">ttf-indic-fonts to fonts-indic transition complete!</a></li>
    
    <li><span>04 Mar 2012</span> &raquo; <a href="/2012/03/lato_fonts_for_debian.html">Lato Fonts for Debian</a></li>
    
  </ul>
</div>

<!-- Disqus -->
<div id="disqus_thread"></div>
<script type="text/javascript">
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'randramblings'; // required: replace example with your forum shortname

  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

        </div>
        <div class="fourcol last">
          <div class="main-menu">
            <div id="home-menu" class="main-menu-item "> <a href="/"> Home </a></div>
            <div id="me-menu" class="main-menu-item "><a href="/about"> About </a></div>
            <div id="project-menu" class="main-menu-item"> Projects and Talks </div>
            <div id="archive-menu" class="main-menu-item "> <a href="/archives"> Archives </a></div>
            <div id="package-menu" class="main-menu-item"> <a href="http://qa.debian.org/developer.php?login=kamathvasudev@gmail.com"> Debian Packages </a> </div>
          </div>
          <br/>
          <hr/>
          <br/>
          <div class="widget">
            Follow Me
            <br/>
            <br/>
            <a href="http://frndk.de/profile/copyninja"><image class="badge" src="/images/iamusingfriendika.png"/></a>
          </div>
          <br/>
          <hr/>
          <br/>
          <a href=><img src= "http://pics8.inxhost.com/images/sticker.gif" border="0" width="80" height="15"/></a>
          <a href="/rss"><img class="badge" width="73" height="18" longdesc="/rss" alt="XML: RSS Feed" src="/images/rssbutton.png"></a>
          <a href="/atom"><img class="badge" width="73" height="18" longdesc="/atom" alt="XML: Atom Feed" src="/images/atombutton.png"></a>
          <a href='https://www.ohloh.net/accounts/153053?ref=Tiny'>
            <img alt='Ohloh profile for copyninja' height='15' src='https://www.ohloh.net/accounts/153053/widgets/account_tiny.gif' width='80' />
          </a>
          <a href='http://www.catb.org/hacker-emblem/'>
            <img src='/images/hacker.png' alt='hacker emblem' />
          </a>
          <br/>
          <br/><a href="http://www.adfreeblog.org/" target="_blank"> <img src="http://www.adfreeblog.org/adfreebutton.jpg"></a>
          <br/>
          <a rel="license" href="http://creativecommons.org/licenses/by/3.0/">
            <img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by/3.0/88x31.png" />
          </a>
          <br/>
</a>          
</div>
</div>
</div>

<!-- Footer -->
<div class="container footer">
  <div class="site">
    <div class="row">
      <div class="footer">
        <div class="contact">
          <p>
            (c) 2012 Vasudeva Kamath<br />
            <br/>
            This blog is powered by <b> Jekyll </b> and <b>Emacs</b>
          </p>
        </div>
      </div>
    </div>
  </div>
</div>
<a href="http://github.com/copyninja"><img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" /></a>

</body>
</html>


