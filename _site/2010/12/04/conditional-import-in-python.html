<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>>Conditional "import" in Python</title>
    <meta name="author" content="Vasudev Kamath" />

    <!-- Normalize CSS -->
    <link rel="stylesheet" href="/blog/css/normalize.css" type="text/css"/>

    <!-- 1140 Grid CSS -->
    <link media="screen" rel="stylesheet" href="/blog/css/1140.css" type="text/css"/>

    <!-- styles.css -->
    <link media="screen" rel="stylesheet" href="/blog/css/styles.css" type="text/css"/>

    <!-- 1140 Grid CSS related javascript -->
    <script src="/blog/js/css3-mediaqueries.js" type="text/javascript"></script>

    
    <!-- syntax highlighting CSS -->
    <link rel="stylesheet" href="/blog/css/emacs.css" type="text/css" />

    <!-- Webfont url -->
    <link rel="stylesheet" href="/blog/fonts/stylesheet-bitstream.css" type="text/css"/>
    <link rel="stylesheet" href="/blog/fonts/stylesheet-angelina.css" type="text/css"/>

    <!-- Homepage CSS -->
    <link rel="stylesheet" href="/blog/css/screen.css" type="text/css" media="screen, projection" />

  </head>
  <body>

    <div class="container header">
      <div class="row">
        <div class="site">
          <div class="title">
            <a href="/">Random Ramblings</a>
          </div>
          <div class="subheading">
            Random thoughts shooting out of volatile mind
          </div>
        </div>
      </div>
    </div>
    <div class="container details">
      <div class="row">
        <div class="eightcol">
          <div id="post">
><div style="text-align: justify;">Normally in Python when we try to import a module and module doesn't exist the interpreter will throw&nbsp; <i>ImportError</i>, this is a normal behavior . But in some cases like when Python version changes some functions are moved from one module to other and sometime the module names itself are changed. For eg. in Python 2.6 we have <i>urllib</i> <i>urllib2</i> modules but in Py3k these modules are combined and all request response related functions are present in <i>urllib.request</i> and all errors are unders <i>urrlib.error</i> module. Functions like <i>urlencode</i> <i>quote</i> <i>unquote</i> which were in <i>urllib</i> module in Python2.6 are under <i>urllib.request </i>Py3k. This case of moving from Python 2.x to Py3k can be easily done by tool called <i>2to3.</i>But lets say moving from Python2.5 to Python2.6 how do we handle this situation?. Well below is the solution <i>(applicable when modules are renamed or moved during version change)</i></div><br /><div style="text-align: justify;"><i><b>Problem:</b></i> When I started working on <a href="http://smc.org.in/silpa">SILPA</a> I was running Debian Squeeze which had Python 2.5 as system default Python, but recently Debian Squeeze transitioned to Python 2.6 as default Python. We had some issue in the URL routing logic of the SILPA which I fixed 2 days back for which I used a function called <i>parse_qs </i>from <i>urlparse</i> module and everything worked fine on my system. I pushed the changes to the main git repository. Now the problem begins 2 mirrors of SILPA have Cron job setup to periodically pull the changes from git, and next day it was reported that 2 of the mirrors where throwing 500 internal server error. And its time for me to find what was causing the issue :).</div><br /><div style="text-align: justify;"><i><b>Reason:</b></i> Mirror instance of the SILPA were running older version of Python.(2.5) and the function <i>parse_qs</i> was not defined in the module <i>urlparse</i> which was causing the <i>ImportError</i>.</div><br /><div style="text-align: justify;"><i><b>Solution:</b></i> I figured out that in Python 2.5 version <i>parse_qs</i> is present but in <i>cgi</i> module instead of <i>urlparse</i>. So to make the code work in both Python versions (i.e. 2.5 and 2.6) I need to do a conditional import as shown below</div><br /><blockquote><i>try:</i><br /><i>&nbsp; &nbsp; from urlparse import parse_qs</i><br /><i>except ImportError:</i><br /><i>&nbsp; &nbsp; # Fall back for Python 2.5 </i><br /><i>&nbsp; &nbsp; from cgi import parse_qs </i></blockquote><br /><div style="text-align: justify;"> So I want to import <i>parse_qs</i> from <i>urlparse</i> module and if interpreter throws <i>ImportError</i> it means the Python version is &lt;2.6 so import the function from <i>cgi</i> module instead. So code is now backward compatible with Python2.5. Well that's it I call this as conditional importing I don't know what is the exact name for this method :). If you have any suggestions please do comment.</div><br />-- Vasudev

</div>

<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li><span>23 Dec 2011</span> &raquo; <a href=" / /2011/12/23/dh-make-font-a-font-package-helper-for-debian.html">>dh-make-font - A Font package helper for Debian</a></li>
    
      <li><span>14 Dec 2011</span> &raquo; <a href=" / /2011/12/14/my-journey-with-debian-and-floss-part-2.html">>My Journey with Debian and FLOSS - Part 2</a></li>
    
      <li><span>13 Dec 2011</span> &raquo; <a href=" / /2011/12/13/my-journey-with-debian-and-floss-part-1.html">>My Journey with Debian and FLOSS - Part 1</a></li>
    
  </ul>
</div>

        </div>
        <div class="fourcol last">
          <div class="widget">
            Connect to me on Friendica
            <script src="http://frndk.de/widgets/friends?k=37533857"></script>
          </div>
        </div>
      </div>
    </div>

    <div class="container footer">
      <div class="site">
        <div class="row">
          <div class="footer">
            <div class="contact">
              <p>
                (c) 2012 Vasudeva Kamath<br />
                The contents of this site are shared under <a href="http://creativecommons.org/licenses/by-sa/3.0/" class="contact">CC-BY-SA-3.0 Unported</a>
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
    <a href="http://github.com/copyninja"><img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" /></a>
  </body>
</html>


