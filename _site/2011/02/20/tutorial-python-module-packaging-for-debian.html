<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>>Tutorial: Python module packaging for Debian</title>
    <meta name="author" content="Vasudev Kamath" />

    <!-- Normalize CSS -->
    <link rel="stylesheet" href="/blog/css/normalize.css" type="text/css"/>

    <!-- 1140 Grid CSS -->
    <link media="screen" rel="stylesheet" href="/blog/css/1140.css" type="text/css"/>

    <!-- styles.css -->
    <link media="screen" rel="stylesheet" href="/blog/css/styles.css" type="text/css"/>

    <!-- 1140 Grid CSS related javascript -->
    <script src="/blog/js/css3-mediaqueries.js" type="text/javascript"></script>

    
    <!-- syntax highlighting CSS -->
    <link rel="stylesheet" href="/blog/css/emacs.css" type="text/css" />

    <!-- Webfont url -->
    <link rel="stylesheet" href="/blog/fonts/stylesheet-bitstream.css" type="text/css"/>
    <link rel="stylesheet" href="/blog/fonts/stylesheet-angelina.css" type="text/css"/>

    <!-- Homepage CSS -->
    <link rel="stylesheet" href="/blog/css/screen.css" type="text/css" media="screen, projection" />

  </head>
  <body>

    <div class="container header">
      <div class="row">
        <div class="site">
          <div class="title">
            <a href="/">Random Ramblings</a>
          </div>
          <div class="subheading">
            Random thoughts shooting out of volatile mind
          </div>
        </div>
      </div>
    </div>
    <div class="container details">
      <div class="row">
        <div class="eightcol">
          <div id="post">
><div dir="ltr" style="text-align: left;" trbidi="on"><div dir="ltr" style="text-align: left;" trbidi="on"><div style="text-align: justify;">In this post I would like to share my experience on packaging <a href="https://savannah.nongnu.org/projects/pypdflib">my first python module</a> for Debian. Its still waiting in the <a href="http://ftp-master.debian.org/new.html">new queue</a> to enter experimental branch of Debian. I would like to give a brief overview of the python module packaging here. I assume the reader knows basics of python module packaging and has gone through the Debian New Maintainers guide.</div><div style="text-align: justify;">For Python module packaging first step is to get the source from the <a href="http://pypi.python.org/pypi">pypi </a>. In my case since I was one of the developer for pypdflib, I just ran the below command to get tar.gz file for pypdflib</div><blockquote><div style="text-align: justify;"><i>python setup.py sdist </i></div></blockquote><div style="text-align: justify;">The archive will be created under <i>dist</i> folder. In my case archive name was <i>pypdflib-0.1.a2.tar.gz</i>. Now copy that to a folder where you want to create the package.</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">Now we need to install a tool called <i>python-stdeb - Python to Debian source package conversion utility. </i>Run the below command to get the package installed</div><blockquote><div style="text-align: justify;"><i>sudo aptitude install python-stdeb</i></div></blockquote><div style="text-align: justify;">&nbsp;Now run the below command to create a .dsc and module source with debian folder template inside it.</div><blockquote><i>py2dsc -m 'Your Name <your@email>' package-version.tar.gz</your@email></i></blockquote><div style="text-align: justify;">&nbsp;Replace the fields appropriately it will create a folder <i>deb_dist</i> in the same directory and the extracted source with debian folder template will be placed under it. </div><blockquote><i>deb_dist</i><br /><i>&nbsp; |</i><br /><i>&nbsp; |___ package-version</i></blockquote><div style="text-align: justify;">Now enter debian directory and edit the <i>control</i> <i>changelog</i> and <i>copyright</i> files to suit your needs. Make the <i>copyright</i> file in&nbsp; <a href="http://dep.debian.net/deps/dep5/">dep5</a> machine readable format. Also I noted that for some reason <i>source/format</i> file under debian directory contained 1.0 (native format). If so please change it to contain the following lines</div><blockquote><i>3.0 (quilt)</i></blockquote><div style="text-align: justify;">That is almost it now running the following command will create the package for your module</div><blockquote><i> debuild</i></blockquote><div style="text-align: justify;">If <i>lintian</i> complaints about issue please fix them, one important thing in Debian packaging is your package should always be lintian clean. </div><br /><div style="text-align: justify;">Now for some special cases there is chance that when you may have to do some extra work. In my case following where happening.</div><div style="text-align: justify;">1. Original source (package-version.orig.tar.gz) was getting modified mainly because of packagename.egg.info folder which is created during compilation.</div><div style="text-align: justify;">2. I had some samples for my module which should be installed as examples.</div><br /><div style="text-align: justify;">For the first problem solution was to override dh_clean section. I added the following lines to my rules file</div><br /><blockquote><i>override_dh_clean:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dh_clean<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rm -rf setuptools_git-0.3.4-*<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rm -rf src/pypdflib.egg-info</i></blockquote><div style="text-align: justify;">What it does is it executes the remove command on 2 folder which were not cleaned automatically by dh_clean.</div><br /><div style="text-align: justify;">For second problem the solution was overriding dh_installexamples section to install my examples manually.</div><br /><blockquote><i>override_dh_installexamples:<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; dh_installexamples -p python-pypdflib samples/*</i></blockquote><div style="text-align: justify;">I didn't put those under /usr/bin/ folder since those examples are not a fully featured tools during the creation. I'll be adding them as tools under /usr/bin using <i>link</i> file in the next release.</div><br />Below is my complete rule file for your reference.<br /><br /></div><script src="https://gist.github.com/836035.js"> </script><br /><br />I thank <a href="http://j4v4m4n.in/"><i>Praveen A</i></a>&nbsp; for guiding me and teaching Debian packaging and <a href="http://qa.debian.org/developer.php?login=kartik"><i>Kartik Mistry</i></a> for helping me in packaging pypdflib and sponsoring it in Debian. My package source now lies in <i>Debian-IN</i> team svn repository. If there are any mistakes please do comment about them :).<br /><br />Reference: <a href="http://meetbot.debian.net/debian-women/2010/debian-women.2010-12-02-20.02.log.html">Debian Woman Python packaging session</a></div>

</div>

<div id="related">
  <h2>Related Posts</h2>
  <ul class="posts">
    
      <li><span>23 Dec 2011</span> &raquo; <a href=" / /2011/12/23/dh-make-font-a-font-package-helper-for-debian.html">>dh-make-font - A Font package helper for Debian</a></li>
    
      <li><span>14 Dec 2011</span> &raquo; <a href=" / /2011/12/14/my-journey-with-debian-and-floss-part-2.html">>My Journey with Debian and FLOSS - Part 2</a></li>
    
      <li><span>13 Dec 2011</span> &raquo; <a href=" / /2011/12/13/my-journey-with-debian-and-floss-part-1.html">>My Journey with Debian and FLOSS - Part 1</a></li>
    
  </ul>
</div>

        </div>
        <div class="fourcol last">
          <div class="widget">
            Connect to me on Friendica
            <script src="http://frndk.de/widgets/friends?k=37533857"></script>
          </div>
        </div>
      </div>
    </div>

    <div class="container footer">
      <div class="site">
        <div class="row">
          <div class="footer">
            <div class="contact">
              <p>
                (c) 2012 Vasudeva Kamath<br />
                The contents of this site are shared under <a href="http://creativecommons.org/licenses/by-sa/3.0/" class="contact">CC-BY-SA-3.0 Unported</a>
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
    <a href="http://github.com/copyninja"><img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub" /></a>
  </body>
</html>


